(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,n){e.exports=n(65)},33:function(e,t,n){},34:function(e,t,n){},51:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(20),l=n.n(r),i=(n(33),n(34),n(21)),o=n(22),u=n(27),c=n(23),p=n(5),d=n(26),h=n(24),m=n.n(h),f=(n(51),n(52),n(7)),v=[["Byparken",30859],["Nonneseter",30862],["Nyg\xe5rd",58545],["Florida",58544],["Danmarksplass",31372],["Kronstad",31374],["Brann stadion",31377],["Wergeland",31379],["Sletten senter",31382],["Slettebakken",31384],["Fantoft",31388],["Paradis",58543],["Hop",29815],["Nesttun terminal",58542],["Nesttun sentrum",58541],["Skjoldskiftet",59851],["M\xe5rdalen",58540],["Skjold",29830],["Lagunen",59849],["R\xe5st\xf8len",58539],["Sandslivegen",58538],["Sandslimarka",30148],["Kokstad",30154],["Birkelandskiftet",58537],["Kokstadflaten",30159],["Bergen lufthavn",58536]],y=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(c.a)(t).call(this,e))).state={schedule:[],loaded:!1,byparken:[],flesland:[],time:null,interval:null,currentstop:null,displaytype:1,stops:null,showsettings:!0},n.setDisplay=n.setDisplay.bind(Object(p.a)(n)),n.setPrefered=n.setPrefered.bind(Object(p.a)(n)),n.changeLayout=n.changeLayout.bind(Object(p.a)(n)),n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;setInterval(function(){e.setState({time:(new Date).toLocaleString().split(",")[1]})},1e3);var t=new f.a,n=t.get("preferedStop");"null"!==n&&void 0!==n||t.set("preferedStop","Byparken",{path:"/",expires:new Date(Date.now()+6048e5)}),this.pickStop(t.get("preferedStop"))}},{key:"pickStop",value:function(e){var t=this;clearInterval(this.state.interval);var n=null,a=null;v.forEach(function(s){s[0]===e&&(n=t.setQuery(s[1]),a=s[0])});var s={headers:{"Content-Type":"application/json","ET-Client-Name":"jakob-rutetabell for bybane"}};this.performQuery(n,s);var r=setInterval(function(){t.performQuery(n,s)},6e4);this.setState({interval:r,currentstop:a})}},{key:"performQuery",value:function(e,t){var n=this;m.a.post("https://api.entur.io/journey-planner/v2/graphql",e,t).then(function(e){n.setState({schedule:e.data,loaded:!0}),n.filterSchedules()}).catch(function(e){console.log("Klarte ikke hente info, pr\xf8v igjen senere ",e.response)})}},{key:"setQuery",value:function(e){return{query:'\n                query {\n                    stopPlace(id:"NSR:StopPlace:'.concat(e,'") {\n                        id\n                        name\n                        estimatedCalls(timeRange: 72100, numberOfDepartures: 20){\n                          aimedArrivalTime\n                          destinationDisplay{\n                            frontText\n                          }\n                          serviceJourney{\n                            journeyPattern{\n                              line{\n                                name\n                              }\n                            }\n                          }\n                        }\n                    }\n                }\n            '),variables:{}}}},{key:"parseTime",value:function(e){var t=new Date,n=new Date,a=e.substring(e.lastIndexOf("T")+1,e.lastIndexOf(":"));if(1===this.state.displaytype)return a;if(0===this.state.displaytype){t.setHours(a.split(":")[0]),t.setMinutes(a.split(":")[1]);var s=(t-n)/1e3/60;return s>=0&&s%1===0?s+" min":null}}},{key:"filterSchedules",value:function(){var e=this,t=[],n=[];this.state.schedule.data.stopPlace.estimatedCalls.forEach(function(a){if("Byparken"===a.destinationDisplay.frontText&&"Byparken"!==e.state.currentstop){var s=e.parseTime(a.aimedArrivalTime);null!=s&&t.push(s)}if("Bergen lufthavn"===a.destinationDisplay.frontText&&"Bergen lufthavn"!==e.state.currentstop){var r=e.parseTime(a.aimedArrivalTime);null!=r&&n.push(r)}}),this.setState({byparken:t,flesland:n})}},{key:"setDisplay",value:function(e){var t,n=this;1===this.state.displaytype?t=0:0===this.state.displaytype&&(t=1),this.setState({displaytype:t},function(){n.filterSchedules()})}},{key:"setPrefered",value:function(e){var t=new f.a;void 0!==t.get("preferedStop")&&(t.remove("preferedStop"),t.set("preferedStop",e,{path:"/",expires:new Date(Date.now()+6048e5)}))}},{key:"changeLayout",value:function(e){var t;e?t=!1:e||(t=!0),this.setState({showsettings:t})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,null!=this.state.currentstop?s.a.createElement("div",null,s.a.createElement("h1",null,"Skyss Rutetabell"),s.a.createElement("button",{className:"button button6",onClick:function(){e.changeLayout(e.state.showsettings)}},this.state.showsettings?"Skjul":"Innstillinger"," "),s.a.createElement("div",{className:this.state.showsettings?"showsettings":"hidesettings"},s.a.createElement("div",null," Velg stopp:",s.a.createElement("select",{className:"dropdown",onChange:function(t){return e.pickStop(t.target.value)},value:null===this.state.currentstop?"byparken":this.state.currentstop},v.map(function(e,t){return s.a.createElement("option",{key:t},e[0])}))),s.a.createElement("div",{className:"button-time"},s.a.createElement("button",{className:"button button4",onClick:this.setDisplay},1===this.state.displaytype?"Minutter":"Klokkeslett"," "),s.a.createElement("button",{className:"button button5",onClick:function(){e.setPrefered(e.state.currentstop)}},"Sett som favoritt"))),s.a.createElement("div",{className:this.state.showsettings?"":"bottom"},s.a.createElement("div",{className:this.state.showsettings?"hidestop":"showstop"},s.a.createElement("p",{className:"stop"},this.state.currentstop)),s.a.createElement("div",{className:"time"},this.state.time),s.a.createElement("div",{className:"right"},s.a.createElement("h3",null,"Mot Flesland"),s.a.createElement("ul",null,this.state.loaded?this.state.flesland.map(function(e,t){return s.a.createElement("li",{key:t},e)}):"Henter Ruter")),s.a.createElement("div",{className:"left"},s.a.createElement("h3",null,"Mot Byparken"),s.a.createElement("ul",null,this.state.loaded?this.state.byparken.map(function(e,t){return s.a.createElement("li",{key:t},e)}):"Henter Ruter")))):s.a.createElement("div",null,s.a.createElement("h2",null,"Henter data...")))}}]),t}(s.a.Component);var k=function(){return s.a.createElement(f.b,null,s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement(y,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[28,1,2]]]);
//# sourceMappingURL=main.9af1c223.chunk.js.map